package com.example.bounce

data class Level(
    val tiles: List<CharArray>,
    val w: Int,
    val h: Int,
    val spawn: Spawn
)

data class Spawn(val x: Float, val y: Float)

object Levels {
    val count get() = maps.size

    fun load(i: Int): Level {
        val lines = maps[i].trim().lines()
        val h = lines.size
        val w = lines.maxOf { it.length }
        val grid = MutableList(h) { CharArray(w) { '.' } }
        var spawn = Spawn(1f, 1f)
        for (y in 0 until h) {
            val row = lines[y]
            for (x in 0 until w) {
                val c = row.getOrNull(x) ?: '.'
                grid[y][x] = c
                if (c == 'S') spawn = Spawn(x + 0.5f, y + 0.5f)
            }
        }
        return Level(grid, w, h, spawn)
    }

    // Legend: #=solid, ^=spike, E=exit, S=spawn, .=air
    private val maps = listOf(
        // Level 1 – tutorial
        """
        ########################
        #S.....#..............E#
        #......#...............#
        #......#...............#
        #......#.....#####.....#
        #............#...#.....#
        #............#...#..^..#
        #......#####.#...#..^..#
        #..........#.#...#..^..#
        #..........#.#...#.....#
        #..........#.#.........#
        #..........#.#.........#
        ########################
        """.trimIndent(),
        // Level 2 – spikes & jumps
        """
        ############################
        #S..................#.....#
        #...................#..^..#
        #..#####............#..^..#
        #......#............#..^..#
        #......#............#.....#
        #......#..########..#..^..#
        #......#............#..^..#
        #......#............#..^..#
        #......#............#..^..#
        #......#............#.....#
        #....................E....#
        ############################
        """.trimIndent(),
        // Level 3 – tight corridors
        """
        ################################
        #S..............###########...#
        #...............#.........#...#
        #.###########...#..^^^^^..#...#
        #.#.........#...#.........#...#
        #.#.#####...#...#.#####...#...#
        #.#.#...#...#...#.#...#...#...#
        #.#.#.E.#...#...#.#.^.#...#...#
        #.#.#####...#...#.#...#...#...#
        #.#.........#...#.........#...#
        #.###########...###########...#
        ################################
        """.trimIndent()
    )
}
